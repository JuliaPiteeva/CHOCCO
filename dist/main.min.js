"use strict";var myMap,init=function(){myMap=new ymaps.Map("map",{center:[55.76,37.65],zoom:13,controls:["zoomControl","routeButtonControl"]}),control=myMap.controls.get("routeButtonControl"),control.routePanel.state.set("from","улица Новый Арбат");var t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/mark.png",iconImageSize:[30,42],iconImageOffset:[-3,-42],zoom:10});[[55.74,37.63],[55.77,37.64],[55.76,37.65],[55.75,37.66]].forEach(function(e){t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")};ymaps.ready(init);var vid=document.getElementById("videoID");vid.oncanplay=function(){var e=document.querySelector(".player__start"),t=document.querySelector(".player"),n=document.querySelector(".player__splash");e.addEventListener("click",function(e){e.preventDefault(),t.classList.contains("paused")?vid.pause():vid.play()}),n.addEventListener("click",function(e){vid.play()});var a=document.getElementById("playbackButtonId");setInterval(function(){var e=vid.duration,t=vid.currentTime,n=s(t,e);l(a,n)},1e3);document.querySelector(".player__playback").addEventListener("click",function(e){var t=e.target,n=parseInt(getComputedStyle(t).width),i=e.layerX,o=vid.duration,r=s(i,n);l(a,r),vid.currentTime=c(o,r)});var i=document.querySelector(".player__volume-level"),r=document.querySelector(".player__volume-btn");r.style.left="50%",i.addEventListener("click",function(e){var t=e.target,n=parseInt(getComputedStyle(t).width),i=e.layerX,o=s(i,n);l(r,o),vid.volume=c(.5,o)});var o=document.querySelector(".player__volume-icon");o.addEventListener("click",function(e){if(o.classList.contains("silent")){vid.volume=.5;var t=100*vid.volume;l(r,t),o.classList.remove("silent")}else vid.volume=0,o.classList.add("silent"),l(r,vid.volume)});var l=function(e,t){e.style.left=t+"%"},s=function(e,t){return e/t*100},c=function(e,t){return e/100*t};vid.onplay=function(){t.classList.add("active"),t.classList.add("paused")},vid.onpause=function(){t.classList.remove("paused"),t.classList.remove("active")}};var hamburgerOpen=document.querySelector(".hamburger-link"),hamburgerMenu=document.querySelector(".hamburger-menu");hamburgerOpen.addEventListener("click",function(e){e.preventDefault(),hamburgerMenu.style.display="block"});var hamburgerClose=document.querySelector(".svg-container");hamburgerMenu=document.querySelector(".hamburger-menu"),hamburgerClose.addEventListener("click",function(){hamburgerMenu.style.display="none"});for(var nutritionLinks=document.querySelectorAll(".bar__nutrition-link"),nutritionShows=document.querySelectorAll(".nutrition"),i=0;i<nutritionLinks.length;i++)nutritionLinks[i].addEventListener("click",function(e){e.preventDefault(),this.nextElementSibling.classList.toggle("nutrition--active")});var menulinkArray=document.getElementsByClassName("menu__link"),menuContentArray=document.getElementsByClassName("menu__desc-content"),closeBtn=document.getElementsByClassName("close");for(i=0;i<menulinkArray.length;i++)menulinkArray[i].addEventListener("click",function(e){e.preventDefault();for(var t=this.nextElementSibling,n=0;n<menuContentArray.length;n++)n==i||t.classList.contains("menu__desc-content--active")||menuContentArray[n].classList.remove("menu__desc-content--active");t.classList.contains("menu__desc-content--active")?t.classList.remove("menu__desc-content--active"):t.classList.add("menu__desc-content--active")});var menuContentCloseArray=document.getElementsByClassName("close");for(i=0;i<menuContentCloseArray.length;i++)menuContentCloseArray[i].addEventListener("click",function(e){this.parentNode.parentNode.classList.remove("menu__desc-content--active")});var teamLinkArray=document.getElementsByClassName("accordeon__title"),accordeonIitem=document.getElementsByClassName("accordeon__item");for(i=0;i<teamLinkArray.length;i++)teamLinkArray[i].addEventListener("click",function(e){e.preventDefault();for(var t=this.parentNode,n=0;n<accordeonIitem.length;n++)n==i||t.classList.contains("accordeon--visible")||accordeonIitem[n].classList.remove("accordeon--visible");t.classList.contains("accordeon--visible")?t.classList.remove("accordeon--visible"):t.classList.add("accordeon--visible")});var myForm=document.querySelector("#form"),send=document.querySelector(".button"),body=document.querySelector("body");function validateForm(e){var t=!0;return validateField(e.elements.name)||(t=!1),validateField(e.elements.phone)||(t=!1),validateField(e.elements.comment)||(t=!1),t}function validateField(e){return e.nextElementSibling.textContent=e.validationMessage,e.checkValidity()}send.addEventListener("click",function(e){if(e.preventDefault(),validateForm(myForm)){var t=new FormData;t.append("name",myForm.elements.phone.value),t.append("phone",myForm.elements.phone.value),t.append("comment",myForm.elements.comment.value),t.append("to","a@a.a");var n=new XMLHttpRequest;n.responseType="json",n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.send(t),n.addEventListener("load",function(){n.response.status?(overlay.open(),body.classList.add("lock"),overlay.setContent("Сообщение отправлено"),myForm.elements.name.value="",myForm.elements.phone.value="",myForm.elements.comment.value=""):(overlay.open(),body.classList.add("lock"),overlay.setContent(n.response.message))})}});var template=document.querySelector("#overlayTemplate").innerHTML,overlay=createOverlay(template);function createOverlay(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector(".overlay"),i=t.querySelector(".content"),o=t.querySelector(".overlay-close");return n.addEventListener("click",function(e){e.target===n&&o.click()}),o.addEventListener("click",function(e){e.preventDefault(),document.body.removeChild(n),body.classList.remove("lock")}),{open:function(){document.body.appendChild(n)},close:function(){o.click()},setContent:function(e){i.innerHTML=e}}}overlay.setContent("Сообщение отправлено");var leftIcon=document.querySelector("#left"),middleIcon=document.querySelector("#middle"),rightIcon=document.querySelector("#right"),reviewsItems=document.querySelectorAll(".reviews__item"),links=document.querySelectorAll(".reviews__link"),slideIndex=1;function showSlides(e){for(var t=0;t<reviewsItems.length;t++)reviewsItems[t].classList.contains("reviews__item--active")&&links[t].classList.contains("reviews__link--active")&&(reviewsItems[t].classList.remove("reviews__item--active"),links[t].classList.remove("reviews__link--active")),reviewsItems[e].classList.add("reviews__item--active"),links[e].classList.add("reviews__link--active")}leftIcon.addEventListener("click",function(e){e.preventDefault(),showSlides(slideIndex=0)}),middleIcon.addEventListener("click",function(e){e.preventDefault(),showSlides(slideIndex=1)}),rightIcon.addEventListener("click",function(e){e.preventDefault(),showSlides(slideIndex=2)});var k=0,timerId=setInterval(function(){showSlides(k),3===++k&&(k=0)},3e3),sections=$(".section"),display=$(".maincontent"),inScroll=!1,md=new MobileDetect(window.navigator.userAgent),isMobile=md.mobile(),countSectionPosition=function(e){var t=-100*e;return isNaN(t)&&console.error("Не верное значение в функции countSectionPosition"),t},resetActiveClass=function(e,t){e.eq(t).addClass("active").siblings().removeClass("active")},performTransition=function(e){inScroll||(inScroll=!0,resetActiveClass(sections,e),resetActiveClass($(".point-nav__item"),e),display.css({transform:"translateY(".concat(countSectionPosition(e),"%)")}),display.on("transformend").length&&(inScroll=!1))},scroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}};$(window).on("wheel",function(e){var t=e.originalEvent.deltaY,n=scroller();0<t&&n.next(),t<0&&n.prev()}),$(document).on("keydown",function(e){var t=scroller(),n=e.target.tagName.toLowerCase();if(!("input"===n||"textarea"===n))switch(e.keyCode){case 38:t.prev();break;case 40:t.next()}}),$("[data-scroll-to]").on("click",function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-scroll-to");performTransition(t)}),isMobile&&$("body").swipe({swipe:function(e,t){var n;"up"===t&&(n="next"),"down"===t&&(n="prev"),scroller()[n]()}});var left=document.querySelector(".left__link"),right=document.querySelector(".right__link"),items=document.querySelector(".slider__list");function loop(e,t){t.preventDefault(),"right"===e?items.appendChild(items.firstElementChild):items.insertBefore(items.lastElementChild,items.firstElementChild)}right.addEventListener("click",function(e){e.preventDefault(),loop("right",e)}),left.addEventListener("click",function(e){e.preventDefault(),loop("left",e)});